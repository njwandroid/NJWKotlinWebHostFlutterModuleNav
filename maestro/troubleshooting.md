# Maestro Troubleshooting Guide

## Common Issues and Solutions

### Installation Issues

**Problem**: Maestro installation fails with permission errors.
**Solution**: Try running the installation command with sudo:

```bash
sudo curl -Ls "https://get.maestro.mobile.dev" | bash
```

**Problem**: Maestro installed but command not found.
**Solution**: Ensure Maestro is in your PATH. For macOS/Linux:

```bash
export PATH="$PATH:$HOME/.maestro/bin"
```

### Device Connection Issues

**Problem**: "No devices found" error when running tests.
**Solutions**:

- Ensure a device/emulator is connected and recognized with `adb devices` (Android) or
  `xcrun simctl list` (iOS)
- Restart the adb server: `adb kill-server && adb start-server`
- For iOS, ensure the simulator is already running before executing tests

### Test Execution Issues

**Problem**: Tests fail with "Element not found" errors.
**Solutions**:

- Increase the timeout for the assertion: `timeout: 10000` (10 seconds)
- Check if the element text or ID is correct
- Verify the app's state before the failing step with screenshots
- Try using different selectors (text, id, xpath)

**Problem**: App crashes during test execution.
**Solution**: Look at the device logs for crash information:

- Android: `adb logcat`
- iOS: Use Console.app or `xcrun simctl spawn booted log stream`

**Problem**: Test flow hangs indefinitely.
**Solution**: Add timeouts to every wait/assertion step and ensure each step has a reasonable
maximum wait time.

### Flutter-Specific Issues

**Problem**: Maestro can't find Flutter elements by text.
**Solutions**:

- Ensure text widgets have semantic labels
- Try using the `testID` property (Flutter) and reference it with `id:` in Maestro
- Use the Maestro Studio to inspect the element hierarchy

**Problem**: Tests work on Android but fail on iOS.
**Solution**: Flutter rendering may differ slightly between platforms. Create platform-specific test
flows for problematic sections.

### Integration Issues

**Problem**: CI pipeline fails but tests pass locally.
**Solutions**:

- Ensure CI environment has the same dependencies installed
- Check device configuration in CI
- Add more logging/screenshots to debug CI-specific issues
- Increase timeouts for slower CI environments

## Debugging Tips

### Enable Verbose Logging

```bash
maestro test --verbose flows/your_flow.yaml
```

### Use Maestro Studio to Inspect Elements

```bash
maestro studio
```

### Generate and Examine Screenshots

```bash
# Run with screenshots (they're generated by default)
maestro test flows/your_flow.yaml
# Screenshots are saved in .maestro/screenshots/
```

### Record Videos of Test Runs

```bash
maestro test --video flows/your_flow.yaml
# Videos are saved in .maestro/videos/
```

### Check Device Logs During Test Execution

For Android:

```bash
adb logcat | grep -E "ActivityManager|AndroidRuntime|Maestro|YourAppName"
```

For iOS:

```bash
xcrun simctl spawn booted log stream --predicate 'process == "YourApp"'
```

## Getting Help

If you've tried the solutions above and are still having issues:

1. Check the [official Maestro documentation](https://maestro.mobile.dev/)
2. Join the [Maestro Discord community](https://discord.gg/maestro)
3. File an issue in our project's GitHub repository
4. Contact the mobile development team for project-specific questions